{% extends "dashboard/base.html" %}

{% block content %}
<div class="dashboard-content">
    <!-- Stats Cards -->
    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-icon">
                <i class="fas fa-chart-line"></i>
            </div>
            <div class="stat-info">
                <div class="stat-number">{{ total_measurements }}</div>
                <div class="stat-label">Total Measurements</div>
            </div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon">
                <i class="fas fa-calendar-day"></i>
            </div>
            <div class="stat-info">
                <div class="stat-number">{{ today_measurements }}</div>
                <div class="stat-label">Today's Measurements</div>
            </div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon">
                <i class="fas fa-heartbeat"></i>
            </div>
            <div class="stat-info">
                <div class="stat-number">Normal</div>
                <div class="stat-label">Health Status</div>
            </div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon">
                <i class="fas fa-clock"></i>
            </div>
            <div class="stat-info">
                <div class="stat-number">
                    {% if current_user.last_login %}
                        {{ convert_timezone(current_user.last_login).strftime('%m/%d') }}
                    {% else %}
                        Today
                    {% endif %}
                </div>
                <div class="stat-label">Last Login</div>
            </div>
        </div>
    </div>
    
    <!-- Recent Measurements -->
    <div class="dashboard-section">
        <div class="section-header">
            <h2>Recent Measurements</h2>
            <a href="{{ url_for('history') }}" class="btn btn-outline">View All</a>
        </div>
        
        <div class="measurements-list">
            {% if recent_measurements %}
                {% for measurement in recent_measurements %}
                    <div class="measurement-item">
                        <div class="measurement-info">
                            <h3>{{ measurement.point_name }}</h3>
                            <p class="measurement-date">
                                {{ convert_timezone(measurement.timestamp).strftime('%B %d, %Y at %I:%M %p') }}
                            </p>
                            <div class="measurement-data">
                                {% if measurement.vpt_voltage %}VPT: {{ measurement.vpt_voltage }}V | {% endif %}
                                {% if measurement.temperature %}Temp: {{ measurement.temperature }}Â°C | {% endif %}
                                {% if measurement.spo2 %}SpO2: {{ measurement.spo2 }}%{% endif %}
                            </div>
                        </div>
                        <div class="measurement-actions">
                            <a href="{{ url_for('view_measurement', measurement_id=measurement.id) }}" class="btn btn-sm">View</a>
                        </div>
                    </div>
                {% endfor %}
            {% else %}
                <div class="empty-state">
                    <i class="fas fa-chart-line"></i>
                    <h3>No Measurements Yet</h3>
                    <p>Your measurements will appear here once the LIWANAG device starts collecting data.</p>
                </div>
            {% endif %}
        </div>
    </div>
    
    <!-- Quick Actions -->
    <div class="dashboard-section">
        <div class="section-header">
            <h2>Quick Actions</h2>
        </div>
        
        <div class="actions-grid">
            <a href="{{ url_for('my_data') }}" class="action-card">
                <div class="action-icon">
                    <i class="fas fa-chart-bar"></i>
                </div>
                <h3>View My Data</h3>
                <p>See your latest measurements and analysis</p>
            </a>
            
            <a href="{{ url_for('history') }}" class="action-card">
                <div class="action-icon">
                    <i class="fas fa-history"></i>
                </div>
                <h3>Measurement History</h3>
                <p>Browse through all your past measurements</p>
            </a>
            
            <a href="{{ url_for('export_measurements') }}" class="action-card">
                <div class="action-icon">
                    <i class="fas fa-download"></i>
                </div>
                <h3>Export Data</h3>
                <p>Download your measurement data as CSV</p>
            </a>
            
            <a href="{{ url_for('profile') }}" class="action-card">
                <div class="action-icon">
                    <i class="fas fa-user-cog"></i>
                </div>
                <h3>Update Profile</h3>
                <p>Manage your account settings</p>
            </a>
        </div>
    </div>
</div>

<style>
.measurement-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1rem;
    border: 1px solid var(--light-gray);
    border-radius: var(--border-radius);
    margin-bottom: 1rem;
    background: var(--white);
}

.measurement-info h3 {
    margin: 0 0 0.5rem 0;
    color: var(--text-dark);
    font-weight: 600;
}

.measurement-date {
    margin: 0 0 0.5rem 0;
    color: var(--gray);
    font-size: 0.9rem;
}

.measurement-data {
    font-size: 0.85rem;
    color: var(--gray);
    font-family: monospace;
}

.actions-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1rem;
}
</style>
{% endblock %}
